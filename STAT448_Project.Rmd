---
title: "STAT 448 - Project"
subtitle: "Human Demographic Contributions to the 2004 Death Rate by U.S. State and County"
author: "Madelaine Brown, Jordyn Lucier, & Harley Clifton"
date: "`r Sys.Date()`"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(nlme)
library(psych)
```


## Importing Data and Data Wrangling

```{r, echo = F}
# setwd("~/College Assignments/Fall 2022/STAT 448/Project")
death.dat <- read_csv("data/FinalProjectData.csv")
summary(death.dat)

## Renaming Variables
colnames(death.dat)[8] = "under.5.years"
colnames(death.dat)[23] = "sex"
colnames(death.dat)[3] = "number.of.physicians"
colnames(death.dat)[24] = "physician.rate"
names(death.dat)

### Removing Row 95 (which is empty)
death.dat <- death.dat[-95, ]

### Renaming Some Counties and States
death.dat[318, 1] <- "D.C."
death.dat[318, 2] <- "D.C."

### replace "NA" with "x" in county names
death.dat[66, 1] <- "Wilcox"
death.dat[112, 1] <- "Baxter"
death.dat[310, 1] <- "Middlesex"
death.dat[317, 1] <- "Sussex"
death.dat[332, 1] <- "Dixie"
death.dat[541, 1] <- "Wilcox"
death.dat[595, 1] <- "Alexander"
death.dat[641, 1] <- "Knox"
death.dat[737, 1] <- "Knox"
death.dat[871, 1] <- "Sioux"
death.dat[1052, 1] <- "Knox"
death.dat[1182, 1] <- "Knox"
death.dat[1184, 1] <- "Oxford"
death.dat[1220, 1] <- "Essex"
death.dat[1224, 1] <- "Middlesex"
death.dat[1244, 1] <- "Charleviox"
death.dat[1312, 1] <- "Wexford"
death.dat[1451, 1] <- "Noxubee"
death.dat[1533, 1] <- "Knox"
death.dat[1588, 1] <- "Texas"
death.dat[1651, 1] <- "Wiboux"
death.dat[1660, 1] <- "Box Butte"
death.dat[1672, 1] <- "Colfax"
death.dat[1681, 1] <- "Dixon"
death.dat[1707, 1] <- "Knox"
death.dat[1736, 1] <- "Sioux"
death.dat[1780, 1] <- "Essex"
death.dat[1785, 1] <- "Middlesex"
death.dat[1792, 1] <- "Sussex"
death.dat[1799, 1] <- "Colfax"
death.dat[1830, 1] <- "Bronx"
death.dat[1843, 1] <- "Essex"
death.dat[1891, 1] <- "Alexander"
death.dat[1931, 1] <- "Halifax"
death.dat[2032, 1] <- "Sioux"
death.dat[2084, 1] <- "Knox"
death.dat[2200, 1] <- "Texas"
death.dat[2347, 1] <- "Lexington"
death.dat[2372, 1] <- "Charles Mix"
death.dat[2474, 1] <- "Knox"
death.dat[2537, 1] <- "Bexar"
death.dat[2660, 1] <- "Knox"
death.dat[2778, 1] <- "Box Elder"
death.dat[2810, 1] <- "Essex"
death.dat[2825, 1] <- "Appomattox"
death.dat[2847, 1] <- "Essex"
death.dat[2848, 1] <- "Fairfax"
death.dat[2860, 1] <- "Halifax"
death.dat[2878, 1] <- "Middlesex"
death.dat[2907, 1] <- "Sussex"
death.dat[2915, 1] <- "Alexandria"
death.dat[2926, 1] <- "Fairfax"
death.dat[2930, 1] <- "Galax"
death.dat[2934, 1] <- "Lexington"
death.dat[2998, 1] <- "Braxton"
death.dat[3105, 1] <- "St. Croix"

### replace "0.01" with "z" in county names
death.dat[90, 1] <- "Valdez Cordova"
death.dat[101, 1] <- "La Paz"
death.dat[142, 1] <- "Izard"
death.dat[285, 1] <- "Montezuma"
death.dat[584, 1] <- "Nez Perce"
death.dat[683, 1] <- "Tazewell"
death.dat[773, 1] <- "Switzerland"
death.dat[1239, 1] <- "Switzerland"
death.dat[1268, 1] <- "Kalamazoo"
death.dat[1481, 1] <- "Yazoo"
death.dat[1558, 1] <- "Ozark"
death.dat[2016, 1] <- "McKenzie"
death.dat[2048, 1] <- "Auglaize"
death.dat[2283, 1] <- "Luzerne"
death.dat[2427, 1] <- "ziebach"
death.dat[2542, 1] <- "Brazoria"
death.dat[2543, 1] <- "Brazos"
death.dat[2607, 1] <- "Garza"
death.dat[2611, 1] <- "Gonzales"
death.dat[2756, 1] <- "Van zandt"
death.dat[2775, 1] <- "Zapata"
death.dat[2776, 1] <- "Zavala"
death.dat[2908, 1] <- "Tazewell"
death.dat[2963, 1] <- "Cowlitz"
death.dat[3046, 1] <- "Wetzel"
death.dat[3095, 1] <- "Ozaukee"

death.dat$County <- gsub("0"," ", death.dat$County)

## Changing County and State to Factors
death.dat$County <- as.factor(death.dat$County)
death.dat$State <- as.factor(death.dat$State)

## Removing Commas from Data Entries
death.dat$income <- gsub(",","", death.dat$income)

## Changing Vars to Numeric Type
names <- c("death.rate", "income", "under.5.years", "prc.5.14.years", "prc.15.24.years",
           "prc.25.34.years", "prc.35.44.years", "prc.45.54.years", "prc.55.64.years", 
           "prc.65.74.years", "prc.75plus.years", "sex", "nh.o.pi",  
           "african.american", "ai.and.an", "hispanic.or.latino", "white", 
           "asian", "physician.rate", "popdensity")
death.dat[,names] <- lapply(death.dat[ , names], as.double)


summary(death.dat)
# Yellowstone National Park, MT no data
# Clifton Forge, VA all value missing except total persons
# South Boston, VA no data
# lots of income data missing for many counties in VA

death.eda <- death.dat

# Another weird county: Kalawao, HI
death.dat[547,]
# this is suspicious so we are going to exclude it
death.dat <- death.dat[-547,]

death.dat <- na.omit(death.dat)
```


$~$

## Exploratory Data Analysis

```{r, echo = F}
ggplot(death.dat) + 
  geom_boxplot(aes(x = State, y = death.rate, fill = State), varwidth = T) + 
  xlab("State") + 
  ylab("Death Rate in 2004") + 
  ggtitle("Boxplots of 2004 Death Rate Distributions by State") +
  theme_bw(base_size = 13) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 90, hjust = 1),
        legend.position = "none") 
  
ggplot(death.dat) + 
  geom_boxplot(aes(x = County, y = death.rate), varwidth = T) + 
  xlab("County") + 
  ylab("Death Rate in 2004") + 
  ggtitle("Boxplots of 2004 Death Rate Distributions by County") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 90, hjust = 1),
        legend.position = "none") 

ggplot(death.dat, aes(x=sex, y=death.rate)) + 
  geom_point() + 
  xlab("Number of Males per 100 Females") + 
  ylab("Death Rate in 2004") + 
  ggtitle("Scatterplot of Males per 100 Females and 2004 Death Rate") +
  theme_bw(base_size = 13) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 90, hjust = 1)) 

ggplot(death.dat, aes(x=income, y=death.rate)) + 
  geom_point() + 
  xlab("Per Capita Income") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of Per Capita Income and 2004 Death Rate") +
  theme_bw(base_size = 13) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=physician.rate, y=death.rate)) + 
  geom_point() + 
  xlab("Physicians Rate, 2004") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of Physician Rate and 2004 Death Rate") +
  theme_bw(base_size = 13) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=under.5.years, y=death.rate)) + 
  geom_point() + 
  xlab("Percent of County Population Under 5 years") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of Percent of Population under 5 Years Old & 2004 Death Rate") +
  theme_bw(base_size = 13) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=prc.5.14.years, y=death.rate)) + 
  geom_point() + 
  xlab("Percent of County Population between 5-14 Years Old") + 
  ylab("Death Rate") +
  ggtitle("Scatterplot of % of Population between 5 to 14 Years Old & Death Rate in 2004") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=prc.15.24.years, y=death.rate)) + 
  geom_point() + 
  xlab("Percent of County Population between 15-24 Years Old") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of % of Population between 15 to 24 Years Old & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 


ggplot(death.dat, aes(x=prc.25.34.years, y=death.rate)) + 
  geom_point()  + 
  xlab("Percent of County Population between 25-34 Years Old") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of % of Population between 25 to 34 Years Old & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=prc.35.44.years, y=death.rate)) + 
  geom_point()+ 
  xlab("Percent of County Population between 35-44 Years Old") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of % of Population between 35 to 44 Years Old & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1))  

ggplot(death.dat, aes(x=prc.45.54.years, y=death.rate)) + 
  geom_point() + 
  xlab("Percent of County Population between 45-54 Years Old") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of % of Population between 45 to 54 Years Old & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=prc.55.64.years, y=death.rate)) + 
  geom_point() + 
  xlab("Percent of County Population between 55-64 Years Old") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of % of Population between 55 to 64 Years Old & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=prc.65.74.years, y=death.rate)) + 
  geom_point()+ 
  xlab("Percent of County Population between 65-74 Years Old") + 
  ylab("Death Rate in 2004") +
  ggtitle("Scatterplot of % of Population between 65 to 74 Years Old & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=prc.75plus.years, y=death.rate)) + 
  geom_point() + 
  xlab("Percent of County Population 75+ Years Old") + 
  ylab("Death Rate") +
  ggtitle("Scatterplot of % of Population 75+ Years Old & Death Rate in 2004") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 


ggplot(death.dat, aes(x=ai.and.an, y=death.rate, col = State)) + 
  geom_point(alpha = 0.4) + 
  xlab("% of County Population that identifies as American Indian/Alkasan Native") + 
  ylab("Death Rate in 2004")+
  ggtitle("% of Population that is American Indian/Alkasan Native & Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=white, y=death.rate, col = State)) + 
  geom_point(alpha = 0.4) + 
  xlab("Percent of County Population that identifies as White") + 
  ylab("Death Rate in 2004")+
  ggtitle("% of Population that is White & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1)) 

ggplot(death.dat, aes(x=african.american, y=death.rate, col = State)) + 
  geom_point(alpha = 0.4) + 
  xlab("Percent of County Population that identifies as African American") + 
  ylab("Death Rate in 2004")+
  ggtitle("% of Population that is African American & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1))  

ggplot(death.dat, aes(x=hispanic.or.latino, y=death.rate, col = State)) + 
  geom_point(alpha = 0.4) + 
  xlab("Percent of County Population that identifies as Hispanic or Latino") + 
  ylab("Death Rate in 2004")+
  ggtitle("% of Population that is Hispanic or Latino & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1))


ggplot(death.dat, aes(x=nh.o.pi, y=death.rate, col = State)) + 
  geom_point(alpha = 0.4) + 
  xlab("Percent of County Pop that identifies as Native Hawaiian/Other/Pacific Islander") + 
  ylab("Death Rate in 2004")+
  ggtitle("% of Population that is Native Hawaiian/Other/Pacific Islander & 2004 Death Rate") +
  theme_bw(base_size = 12) +  # Makes font size bigger
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(hjust = 1))



# Tally of Number of Counties in each State
summary(death.eda$State)


# Scatterplot Correlation Matrix
deathsub <- select(death.dat, death.rate, physician.rate, income, white,
                   african.american, hispanic.or.latino,  asian, ai.and.an, nh.o.pi)
pairs.panels(deathsub, 
             method = "pearson", # correlation method
             hist.col = "#00AFBB",
             density = TRUE,  # show density plots
             ellipses = FALSE
             )

```


$~$

## Initial Model 

**Step 1:** _Start with fixed effect model with all terms and interactions, this is the "Beyond Optimal Model"._

```{r, echo = F}
## First Scaling Some Variables

death.dat$income <- as.numeric(scale(death.dat$income))


## Now fitting the Beyond Optimal Model

m1.gls <- gls(death.rate ~ physician.rate + income + under.5.years + popdensity +
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
           physician.rate*hispanic.or.latino + income*physician.rate,
           data = death.dat, 
           method = "REML", 
          na.action=na.omit)

summary(m1.gls)
```


$~$

## Variable & Model Selection

**Step 2:** _With the Beyond Optimal Model, find the "optimal" random effect structure._

```{r, echo = F}
m2 <- lme(death.rate ~ physician.rate + income + under.5.years + popdensity +
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          data= death.dat, na.action=na.omit)

summary(m2)

# m3 <- lme(death.rate ~ physician.rate + income + under.5.years + popdensity +
#           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
#           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
#           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
#           sex + physician.rate*white + physician.rate*african.american +
#           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
#           physician.rate*hispanic.or.latino + income*physician.rate,
#          random = list(~ 1 | State, ~1 | County), 
#          data= death.dat, na.action=na.omit)

# summary(m3)

anova(m1.gls, m2)
```

Since this data is not from a designed study and there is only one observation per county, including county as a random effect in our model will result in over fitting. 


**Step 3:** _Now find the "optimal" fixed effects structure._

Note: to compare models with different fixed effects structures, we must fit them using Maximum likelihood estimation.

```{r, echo = F}
mem1 <- lme(death.rate ~ physician.rate + income + under.5.years + popdensity +
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem1)


#remove popdensity
mem2 <- lme(death.rate ~ physician.rate + income + under.5.years + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem2)


#remove under.5.years
mem3 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem3)


#remove physician.rate:nh.o.pi
mem4 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem4)


#remove physician.rate:hispanic.or.latino
mem5 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + 
           income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem5)


#remove physician.rate:ai.and.an
mem6 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem6)


#remove physician.rate:white
mem7 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*african.american +
           physician.rate*asian + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem7)


#remove physician.rate:asian
mem8 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*african.american + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data = death.dat, 
          na.action=na.omit)

summary(mem8)


#remove white
mem9 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*african.american + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data = death.dat, 
          na.action=na.omit)

summary(mem9)


#remove nh.o.pi
mem10 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + hispanic.or.latino + 
           sex + physician.rate*african.american + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data = death.dat, 
          na.action=na.omit)

summary(mem10)



#remove physician.rate*african.american
mem11 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + hispanic.or.latino + 
           sex + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data = death.dat, 
          na.action=na.omit)

summary(mem11)


#remove physician.rate*african.american
mem11.5 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          method = "ML",
          data = death.dat, 
          na.action=na.omit)

summary(mem11.5)


#remove income*physician.rate
mem12 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + hispanic.or.latino + 
           sex,
          random = list(~ 1 | State), 
          method = "ML",
          data = death.dat, 
          na.action=na.omit)

summary(mem12)

#remove physician.rate
mem13 <- lme(death.rate ~ income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + hispanic.or.latino + 
           sex,
          random = list(~ 1 | State), 
          method = "ML",
          data = death.dat, 
          na.action=na.omit)

summary(mem13)


#remove sex
mem14 <- lme(death.rate ~ income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + hispanic.or.latino,
          random = list(~ 1 | State), 
          method = "ML",
          data = death.dat, 
          na.action=na.omit)

summary(mem14)


anova(mem1, mem2, mem3, mem4, mem5, mem6, mem7, mem8, mem9, mem10, mem11, mem11.5, mem12, mem13, mem14)
```

We decided to go with `mem11.5` for our final model.

$~$

## Model Diagnostics

**Step 4:** _Validate the Final Model._

We need to start by refitting the final model using REML, which gives us unbiased coefficient estimates.

```{r echo=FALSE}
## Refit using REML and look at diagnostics
m.final <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          method = "REML",
          data = death.dat, 
          na.action=na.omit)

summary(m.final)
```

Once the model has been appropriately refit, we should check model diagnostics.

```{r, echo = F}
# Residual vs. Fitted plot
plot(m.final, type=c("p","smooth"), col.line=1,
     main = "Normalized Residual vs. Fitted plot for Original Model")
```

There is a clear increasing fanning pattern present in the Normalized Residual vs. Fitted plot, indicating evidence against the constant variance assumption.


```{r, echo = F}
## Q-Q Plot
qqnorm(residuals(m.final), main = "Normal Q-Q Plot for the REML Model",
       xlab = "Theoretical Quantiles", ylab = "Sample Quantiles")
qqline(m.final$residuals, col = "red", lwd = 2)
```

The residuals deviate from the 1:1 Q-Q line heavy tail pattern which is very problematic and a clear violation of the normality of residuals assumption.



```{r, echo = F}
## Scale Location plot
plot(m.final,
     sqrt(abs(resid(.)))~fitted(.),
     type=c("p","smooth"), col.line=1,
     main = "Scale Location Plot for Final Model")
```

Since little evidence against the linearity assumption was found in the Residual vs. Fitted plot, we can use the Scale Location plot to further assess constant variance. This plot show further evidence against homoskedacity and also suggests the presence of missed curvature. 


### Assessing Normality of Random Effects

```{r, echo = F}
m.final.ranef <- ranef(m.final)

hist(m.final.ranef[,1], 
     main = "Histogram for the Random Effects   \n   for the 50 States & the District of Columbia",
     xlab = "Random Effects for the 50 States & D.C.",
     col = "goldenrod1")
```


The random effects for State are centered around zero and approximately normally distributed, providing little to no evidence against the assumption of normal random effects.

$~$

## Trying a log-transformed Response

Given the clear violations of our assumptions, a log-transformation of death rate was used as the response to investigate whether this would improve any diagnostics.

```{r, echo = F}
summary(death.dat$death.rate) #making sure we don't have any zero values

m.log <- lme(log(death.rate) ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          method = "REML",
          data = death.dat, 
          na.action=na.omit)


summary(m.log)
```

```{r, echo = F}
# Residual vs. Fitted plot
plot(m.log, type=c("p","smooth"), col.line=1,
     main = "Normalized Residual vs. Fitted plot for Log-Response Model")
```

Less fanning in residuals, but now more of a diamond shape. Still problematic, and there is evidence of potential non-linearity / missed curvature.

```{r, echo = F}
## Q-Q Plot
qqnorm(residuals(m.log), main = "Normal Q-Q Plot for the Log-Response Model",
       xlab = "Theoretical Quantiles", ylab = "Sample Quantiles")
qqline(m.log$residuals, col = "red", lwd = 2)
```

Got rid of the heavy right tail, but now there is an extra heavy left tail. Resulted in heavy right skew in residuals which violates normality.


### Assessing Normality of Random Effects

```{r, echo = F}
m.log.ranef <- ranef(m.log)

hist(m.log.ranef[,1], 
     main = "Histogram for the Random Effects   \n   for the 50 States & the District of Columbia",
     xlab = "Random Effects for the 50 States & D.C.",
     col = "goldenrod1")
```

Random effects are now clearly left skewed, introducing a newly violated assumption.


**Based on these diagnostics, we determined that log-transforming the response did not improve our model diagnostics. Therefore, we decide to explore non-constant variance structures instead.**


$~$

## Trying a Non-Constant Variance Structure

```{r, echo = FALSE}
death.dat$resid = resid(m.final, type="normalized")

plot(resid~prc.15.24.years, data=death.dat)
plot(resid~prc.25.34.years, data=death.dat, 
     main = "Residual Plot for Percent of Population between Ages 25 to 34",
     ylab = "Residuals",
     xlab = "Percent of County Population between Ages 25 and 34")
plot(resid~prc.35.44.years, data=death.dat)
plot(resid~prc.45.54.years, data=death.dat)
plot(resid~prc.55.64.years, data=death.dat)
plot(resid~prc.65.74.years, data=death.dat)
plot(resid~prc.75plus.years, data=death.dat)

varpower1 = lme(death.rate ~ physician.rate + income + prc.5.14.years + 
                  prc.15.24.years + prc.25.34.years + prc.35.44.years + 
                  prc.45.54.years + prc.55.64.years + prc.65.74.years + 
                  prc.75plus.years + african.american + asian + ai.and.an + 
                  hispanic.or.latino + physician.rate*income, 
                random = list(~1|State), 
                data= death.dat, 
                weights = varPower(form=~prc.15.24.years), 
                method = "ML")

varpower2 = lme(death.rate ~ physician.rate + income + prc.5.14.years + 
                        prc.15.24.years + prc.25.34.years + prc.35.44.years + 
                        prc.45.54.years + prc.55.64.years + prc.65.74.years + 
                        prc.75plus.years + african.american + asian + ai.and.an + 
                        hispanic.or.latino + physician.rate*income, 
                      random = list(~1|State), 
                      data= death.dat, 
                      weights = varPower(form=~prc.25.34.years), 
                      method = "ML")

varpower3 = lme(death.rate ~ physician.rate + income + prc.5.14.years + 
                      prc.15.24.years + prc.25.34.years + prc.35.44.years + 
                      prc.45.54.years + prc.55.64.years + prc.65.74.years + 
                      prc.75plus.years + african.american + asian + ai.and.an + 
                      hispanic.or.latino + physician.rate*income, 
                    random = list(~1|State), 
                    data= death.dat, 
                    weights = varPower(form=~prc.35.44.years), 
                    method = "ML")

varpower4 = lme(death.rate ~ physician.rate + income + prc.5.14.years + 
                   prc.15.24.years + prc.25.34.years + prc.35.44.years + 
                   prc.45.54.years + prc.55.64.years + prc.65.74.years + 
                   prc.75plus.years + african.american + asian + ai.and.an + 
                   hispanic.or.latino + physician.rate*income, 
                 random = list(~1|State), 
                 data= death.dat, 
                 weights = varPower(form=~prc.45.54.years), 
                 method = "ML")

varpower5 = lme(death.rate ~ physician.rate + income + prc.5.14.years + 
             prc.15.24.years + prc.25.34.years + prc.35.44.years + 
             prc.45.54.years + prc.55.64.years + prc.65.74.years + 
             prc.75plus.years + african.american + asian + ai.and.an + 
             hispanic.or.latino + physician.rate*income, 
           random = list(~1|State), 
           data= death.dat, 
           weights = varPower(form=~prc.55.64.years), 
           method = "ML")

varpower6 = lme(death.rate ~ physician.rate + income + prc.5.14.years + 
                         prc.15.24.years + prc.25.34.years + prc.35.44.years + 
                         prc.45.54.years + prc.55.64.years + prc.65.74.years + 
                         prc.75plus.years + african.american + asian + ai.and.an + 
                         hispanic.or.latino + physician.rate*income, 
                       random = list(~1|State), 
                       data= death.dat, 
                       weights = varPower(form=~prc.65.74.years), 
                       method = "ML")

varpower7 = lme(death.rate ~ physician.rate + income + prc.5.14.years + 
                    prc.15.24.years + prc.25.34.years + prc.35.44.years + 
                    prc.45.54.years + prc.55.64.years + prc.65.74.years + 
                    prc.75plus.years + african.american + asian + ai.and.an + 
                    hispanic.or.latino + physician.rate*income, 
                  random = list(~1|State), 
                  data= death.dat, 
                  weights = varPower(form=~prc.75plus.years), 
                  method = "ML")

anova(varpower1, varpower2, varpower3, varpower4, varpower5, varpower6, varpower7)
```


```{r, echo = FALSE}
varpower2 = lme(death.rate ~ physician.rate + income + prc.5.14.years + 
                        prc.15.24.years + prc.25.34.years + prc.35.44.years + 
                        prc.45.54.years + prc.55.64.years + prc.65.74.years + 
                        prc.75plus.years + african.american + asian + ai.and.an + 
                        hispanic.or.latino + physician.rate*income, 
                      random = list(~1|State), 
                      data= death.dat, 
                      weights = varPower(form=~prc.25.34.years), 
                      method = "REML")

summary(varpower2)
```


```{r, echo = FALSE}
plot(varpower2, type=c("p","smooth"), col.line=1,
     main = "Normalized Residual vs. Fitted plot for the VarPower Model fit with")
```

Better!

```{r, echo = FALSE}
qqnorm(residuals(varpower2), main = "Normal Q-Q Plot for the VarPower Model",
       xlab = "Theoretical Quantiles", ylab = "Sample Quantiles")
qqline(varpower2$residuals, col = "red", lwd = 2)
```

About the same as before.

```{r, echo = FALSE}
plot(varpower2, sqrt(abs(resid(.)))~fitted(.), type=c("p","smooth"), col.line=1, main = "Scale Location Plot for VarPower Model")
```

Meh.


### Redoing Variable Selection with the VarPower Variance Structure Model

```{r}
mem11.5.1 <- lme(death.rate ~ physician.rate + income + under.5.years + popdensity +
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.1)


#remove under.5.years
mem11.5.2 <- lme(death.rate ~ physician.rate + income + popdensity +
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.2)


#remove population density
mem11.5.3 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an + physician.rate*nh.o.pi + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.3)


#remove physician.rate:nh.o.pi
mem11.5.4 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american +
           physician.rate*asian + physician.rate*ai.and.an  + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.4)


#remove physician.rate:asian 
mem11.5.5 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*white + physician.rate*african.american + physician.rate*ai.and.an  + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.5)


#remove physician.rate:white
mem11.5.6 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*african.american  + physician.rate*ai.and.an  + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.6)


#remove physician.rate:ai.and.an
mem11.5.7 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           white + african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*african.american + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.7)


#remove white 
mem11.5.8 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an + nh.o.pi + hispanic.or.latino + 
           sex + physician.rate*african.american + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.8)


#remove nh.o.pi 
mem11.5.9 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + ai.and.an  + hispanic.or.latino + 
           sex + physician.rate*african.american + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.9)


#remove ai.and.an
mem11.5.10 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + hispanic.or.latino + 
           sex + physician.rate*african.american + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.10)


#remove sex
mem11.5.11 <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + hispanic.or.latino + physician.rate*african.american + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "ML",
          data= death.dat, 
          na.action=na.omit)

summary(mem11.5.11)


#final model is mem11.5.11

anova(mem11.5.1, mem11.5.2, mem11.5.3, mem11.5.4, mem11.5.5, mem11.5.6, 
      mem11.5.7, mem11.5.8, mem11.5.9, mem11.5.10, mem11.5.11)

```

Refit the final model using REML:

```{r, echo = F}
final <- lme(death.rate ~ physician.rate + income + 
           prc.5.14.years + prc.15.24.years + prc.25.34.years + prc.35.44.years + 
           prc.45.54.years + prc.55.64.years + prc.65.74.years + prc.75plus.years + 
           african.american + asian + hispanic.or.latino + physician.rate*african.american + 
           physician.rate*hispanic.or.latino + income*physician.rate,
          random = list(~ 1 | State), 
          weights = varPower(form=~prc.25.34.years),
          method = "REML",
          data= death.dat, 
          na.action=na.omit)

summary(final)

intervals(final, level = 0.95,
          which = c("fixed"))
```

Now, final assessment of Diagnostics:

```{r, echo = F}
# Residual vs. Fitted plot
plot(final, type=c("p","smooth"), col.line=1,
     main = "Normalized Residual vs. Fitted plot for varPower Model")
```

There is only a slight increasing fanning pattern present in the Normalized Residual vs. Fitted plot, indicating little evidence against the constant variance assumption. This graph suggests that there is very minor missed curvature, providing little evidence against the Linearity assumption.


```{r, echo = F}
## Q-Q Plot
qqnorm(residuals(final), main = "Normal Q-Q Plot for the Final Model",
       xlab = "Theoretical Quantiles", ylab = "Sample Quantiles")
qqline(final$residuals, col = "red", lwd = 2)
```

The residuals deviate from the 1:1 Q-Q line heavy tail pattern which is problematic and a clear violation of the normality of residuals assumption. However, this is not any worse than it originally was.


```{r, echo = F}
## Scale Location plot
plot(final,
     sqrt(abs(resid(.)))~fitted(.),
     type=c("p","smooth"), col.line=1,
     main = "Scale Location Plot for Final Model")
```

Since little evidence against the linearity assumption was found in the Residual vs. Fitted plot, we can use the Scale Location plot to further assess constant variance. This plot shows some evidence against homoskedacity, but less than before, and also suggests the presence of missed curvature. 


### Assessing Normality of Random Effects

```{r, echo = F}
final.ranef <- ranef(final)

hist(final.ranef[,1], 
     main = "Histogram for the Random Effects   \n   for the 50 States & the District of Columbia",
     xlab = "Random Effects for the 50 States & D.C.",
     col = "goldenrod1")
```

The random effects for State are centered around zero and approximately normally distributed, providing little to no evidence against the assumption of normal random effects.

$~$


## Final Theorhetical Model

$DeathRate_{ij} =  \beta_0  +  \beta_1  Physician Rate_{ij}  +  \beta_2  Income_{ij} +  \beta_3  PercentAge5to14_{ij} +  \beta_4  PercentAge15to24_{ij}$

$+  \beta_5  PercentAge25to34_{ij} +  \beta_6  PercentAge35to44_{ij}  +  \beta_7  PercentAge45to54_{ij} +  \beta_8  PercentAge55to64_{ij}$

$+  \beta_9  PercentAge65to74_{ij}  +  \beta_{10}  PercentAge75plus_{ij}  +  \beta_{11} PercentAfricanAmerican_{ij} +  \beta_{12}  PercentAsian_{ij}$

$+  \beta_{13}  PercentHispanicOrLatino_{ij} +  \beta_{14}  PhysicianRate_{ij} : PercentAfricanAmerican_{ij}$

$+  \beta_{15}  PhysicianRate_{ij} : PercentHispanicOrLatino_{ij} + \beta_{16} PhysicianRate_{ij} : Income_{ij} + \underline{\smash{\beta_{17}}} X_{State_{ij}} + \epsilon_{ij}$

$\epsilon_{ij} \sim N(0, \sigma^2 |PercentAge25to34_{ij}|^{2 \delta})$



## Final Estimated Model

$\widehat{DeathRate_{ij}} =  39.71716  -  0.00210  Physician Rate_{ij}  -  0.00011  Income_{ij}$

$-  0.44548  PercentAge5to14_{ij}  -  0.39574  PercentAge15to24_{ij}  -  0.38688  PercentAge25to34_{ij}$

$-  0.33072  PercentAge35to44_{ij}  -  0.35441  PercentAge45to54_{ij}  -  0.15201  PercentAge55to64_{ij}$

$-  0.26820  PercentAge65to74_{ij}  +  0.39235  PercentAge75plus_{ij}  +  0.01682  PercentAfricanAmerican_{ij}$

$-  0.05235  PercentAsian_{ij}  -  0.04246  PercentHispanicOrLatino_{ij}$

$+  0.000013  PhysicianRate_{ij} : PercentAfricanAmerican_{ij}$

$+  0.000038  PhysicianRate_{ij} : PercentHispanicOrLatino_{ij}  +  0.000000061  PhysicianRate_{ij} : Income_{ij}$

$\epsilon_{ij} \sim N(0, \sigma^2$ x $|PercentAge25to34_{ij}|^{2(-1.217987)})$


$~$

## Citations

```{r, echo = F}
citation("ggplot2")
citation("psych")
citation("nlme")
```

